<link rel="import" href="../bower_components/polymer-redux/polymer-redux.html">
<script src="../node_modules/redux/dist/redux.js"></script>
<script src="../node_modules/redux-logger/dist/redux-logger.js"></script>
<script src="../node_modules/redux-trunk/dist/redux-trunk.js"></script>
<script src="../node_modules/redux-promise-middleware/dist/redux-promise-middleware.js"></script>

<script>
    // Setup a Redux store
    const initial = {
        loading: false,
        username: null,
        message: 'Hello, World!'
    };

    const authReducer = (state= { loading:false, user: null }, action) => {
        switch (action.type) {
            case 'SIGN_UP_STARTED':
                return Object.assign({}, state, {loading: true});

            case 'SIGN_UP_COMPLETED':
                return Object.assign({}, state, {
                    loading: false,
                    username: action.username
                });
        }
        return state;
    };

//    const reducer = state => state;
    const messageReducer = (state= {message: 'No message'}, action) => {
        if (!state) return initial;

        switch (action.type) {

            case 'UPDATE_MESSAGE':
                // ALWAYS return new state
                return Object.assign({}, state, {
                    message: action.message // New message
                });

            // Return the state, nothing changed.
            default:
                return state;
        }
    };

    const store = Redux.createStore(
        Redux.combineReducers( {
            auth:authReducer,
            messageReducer

        }),
        Redux.applyMiddleware(ReduxThunk.default));

    // Export the ReduxMixin
    ReduxMixin = PolymerRedux(store);
</script>